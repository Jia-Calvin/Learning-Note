# MongoDB副本集以及分片副本集
主要记载原生MongoDB 4.8版本的学习记录，包括了架构与一些配置的注意事项。主要分为两大部分，副本集以及分片的副本集。
##  副本集
* ### 1. 架构图

* ### 2. 副本集注意事项
  - MongoDB副本集中所有的节点都包含相同的数据（俗称备机）
  - 不同节点间是通过oplog进行数据同步的，oplog是固定大小的集合（可调整）
  - 头条一般是1主1副1仲裁（Arbiter） 或者 1主2副，因此一个副本集内通常含有三个节点
  - 节点数量要设置为奇数是更符合实际生产环境的：
    - 多数节点应放置在主要的数据中心，调整优先级使主节点出现在主要数据中心
    - 在两个重要的数据中心放置相同数量的节点，在第三个不太重要的数据中心放置一个节点
    - 例如：
      - 3个节点的副本集，当主节点挂掉后，还有2个节点能够正常地推选出主节点处理读写
      - 5个节点的副本集，当挂掉了2个节点，依然能够推选出主节点处理读写
    - 仲裁者（Arbiter）不存储任何数据，仅作选举作用，它是为了将副本集节点数量凑到奇数。举例来说有无仲裁者的作用：
      - 1主1副无仲裁共2个节点的副本集，主节点挂掉后，没有足够的节点数量「(节点总数+1)/2」推选新的主节点。
      - 1主1副1仲裁，当主节点挂掉后，仲裁者也可以投票给副节点推选它为新的主节点。
    - 仲裁者数量最好只有一个，存储数据的节点能够为主节点降低负载，当挂掉的副节点恢复时，它会尝试去寻找其余的副节点进行同步，若过多的仲裁者，则挂掉并恢复的副节点就只能找主节点进行数据的同步。

* ### 3. 副本集启动流程以及配置
  - 这里以启动本地三个节点的副本集为例子，介绍启动流程与节点的配置：

